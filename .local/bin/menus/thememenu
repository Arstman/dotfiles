#!/bin/sh

result=$(ls -1 ${XDG_CONFIG_HOME}/X11/themes | dmenu -r -i -p "Select color theme:" -l 9)

[ -z "$result" ] && exit

dir="${XDG_CONFIG_HOME}/X11"

if [ -h "$dir/current_theme" ]; then
	# Only continue if switching to a different theme
	current_theme=$(readlink -f "$dir/current_theme" | sed "s/^.*\///g")
	if [ "$result" != "$current_theme" ]; then
		rm "$dir/current_theme"
		ln -s "$dir/themes/$result" "$dir/current_theme"
		xrdb -merge "$dir/current_theme"
		xres_alacritty &
		notify-send "Theme" "Changed theme to $result"
	else
		echo "OK" | dmenu -r -i -p "Theme is already selected" && exit
	fi
fi
