#!/bin/sh
# Requires brightnessctl

brightness="$(awk 'BEGIN {printf("%-3d\n", '"$(brightnessctl g)"' / '"$(brightnessctl m)"' * 100)}')"

# No arguments - query brightness level
if [ $# -eq 0 ]; then
    pangoify -s -t 'ó°ƒž'
    pangoify -t " $brightness"
    printf "    "
    exit
else

    # Use the value '5' if 2nd argument is missing
    delta="${2:-5}"

    case "$1" in
	up) 
	    laptop=$((brightness+delta)) 
	    ;;
	down) 
	    laptop=$((brightness-delta)) 
	    ;;
    esac

    external=$((laptop-30))

    brightnessctl s ${laptop}% 
    ddcutil setvcp 10 ${external}

    # Update dwmblocks brightness module
    # update signal: 11 + 34
    kill -45 $(pidof dwmblocks)

fi
